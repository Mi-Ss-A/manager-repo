<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>통합 관리자 대시보드</title>
    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- DataTables 기본 CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
</head>
<body class="bg-gray-100">
<div class="w-full max-w-7xl mx-auto p-4">
    <!-- 상단 헤더 섹션 -->
    <div class="mb-8 flex justify-between items-center">
        <div>
            <h1 class="text-3xl font-bold mb-2">통합 관리자 대시보드</h1>
            <p class="text-gray-600">서비스 메시 모니터링 및 상품 관리</p>
        </div>
    </div>

    <!-- OpenAI 사용량 데이터 테이블 섹션 -->
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-xl font-bold mb-4">OpenAI 사용량 데이터</h2>
        <div>
            <table id="usageTable" class="display w-full">
                <thead>
                <tr>
<!--                    <th>조직 ID</th>-->
<!--                    <th>조직 이름</th>-->
                    <th>스냅샷 ID</th>
                    <th>요청 수</th>
                    <th>컨텍스트 토큰</th>
                    <th>생성된 토큰</th>
                </tr>
                </thead>
                <tbody>
                <!-- usageData.data를 Java 객체로 사용 -->
                <tr th:each="item : ${usageData.data}" th:if="${usageData.data != null}">
<!--                    <td th:text="${item.organizationId}">-</td>-->
<!--                    <td th:text="${item.organizationName}">-</td>-->
                    <td th:text="${item.snapshotId}">-</td>
                    <td th:text="${item.nRequests}">0</td>
                    <td th:text="${item.nContextTokensTotal}">0</td>
                    <td th:text="${item.nGeneratedTokensTotal}">0</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>


    <!--    &lt;!&ndash; 그리드 레이아웃: Istio 메트릭 + 관리자 기능 &ndash;&gt;-->
<!--    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">-->
<!--        &lt;!&ndash; 왼쪽: Istio 메트릭 섹션 &ndash;&gt;-->
<!--        <div class="lg:col-span-2 space-y-6">-->
<!--            &lt;!&ndash; 메트릭 카드 섹션 &ndash;&gt;-->
<!--            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">-->
<!--                &lt;!&ndash; 총 서비스 카드 &ndash;&gt;-->
<!--                <div class="bg-white rounded-lg shadow-md">-->
<!--                    <div class="p-4 border-b flex items-center space-x-2">-->
<!--                        <i data-lucide="box" class="w-4 h-4"></i>-->
<!--                        <h3 class="font-semibold">총 서비스</h3>-->
<!--                    </div>-->
<!--                    <div class="p-4">-->
<!--                        <p class="text-2xl font-bold" th:text="${metrics.totalServices}">24</p>-->
<!--                    </div>-->
<!--                </div>-->

<!--                &lt;!&ndash; 활성 게이트웨이 카드 &ndash;&gt;-->
<!--                <div class="bg-white rounded-lg shadow-md">-->
<!--                    <div class="p-4 border-b flex items-center space-x-2">-->
<!--                        <i data-lucide="terminal" class="w-4 h-4"></i>-->
<!--                        <h3 class="font-semibold">활성 게이트웨이</h3>-->
<!--                    </div>-->
<!--                    <div class="p-4">-->
<!--                        <p class="text-2xl font-bold" th:text="${metrics.activeGateways}">3</p>-->
<!--                    </div>-->
<!--                </div>-->

<!--                &lt;!&ndash; 경고 카드 &ndash;&gt;-->
<!--                <div class="bg-white rounded-lg shadow-md">-->
<!--                    <div class="p-4 border-b flex items-center space-x-2">-->
<!--                        <i data-lucide="alert-circle" class="w-4 h-4"></i>-->
<!--                        <h3 class="font-semibold">경고</h3>-->
<!--                    </div>-->
<!--                    <div class="p-4">-->
<!--                        <p class="text-2xl font-bold" th:text="${metrics.alerts}">2</p>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->

            <!-- OpenAI Usage Display -->


<!--            &lt;!&ndash; 시스템 상태 섹션 &ndash;&gt;-->
<!--            <div class="bg-white rounded-lg shadow-md">-->
<!--                <div class="p-4 border-b">-->
<!--                    <h3 class="font-semibold">시스템 상태</h3>-->
<!--                </div>-->
<!--                <div class="p-4">-->
<!--                    <div class="space-y-2">-->
<!--                        <div class="flex justify-between items-center">-->
<!--                            <span>Virtual Services</span>-->
<!--                            <span class="font-medium" th:text="${metrics.totalVirtualServices}">12</span>-->
<!--                        </div>-->
<!--                        <div class="flex justify-between items-center">-->
<!--                            <span>Destination Rules</span>-->
<!--                            <span class="font-medium" th:text="${metrics.totalDestinationRules}">8</span>-->
<!--                        </div>-->
<!--                        <div class="flex justify-between items-center">-->
<!--                            <span>네임스페이스</span>-->
<!--                            <span class="font-medium" th:text="${metrics.totalNamespaces}">5</span>-->
<!--                        </div>-->
<!--                        <div class="flex justify-between items-center">-->
<!--                            <span>건강한 서비스</span>-->
<!--                            <span class="font-medium" th:text="${metrics.healthyServices}">10</span>-->
<!--                        </div>-->
<!--                        <div class="flex justify-between items-center">-->
<!--                            <span>문제 있는 서비스</span>-->
<!--                            <span class="font-medium" th:text="${metrics.unhealthyServices}">2</span>-->
<!--                        </div>-->
<!--                        <div class="flex justify-between items-center">-->
<!--                            <span>평균 지연 시간</span>-->
<!--                            <span class="font-medium" th:text="${metrics.averageLatency + 'ms'}">150ms</span>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

        <!-- 오른쪽: 관리자 기능 섹션 -->
        <div class="lg:col-span-1">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-bold mb-4">관리자 기능</h2>
                <div class="space-y-3">
                    <div class="space-y-2">
                        <h3 class="font-medium text-gray-700">상품 추가</h3>
                        <div class="space-y-2">
                            <a th:href="@{/card/add}" class="flex items-center p-2 bg-blue-50 text-blue-700 rounded hover:bg-blue-100 transition">
                                <i data-lucide="credit-card" class="w-4 h-4 mr-2"></i>
                                카드 상품 추가
                            </a>
                            <a th:href="@{/loans/add}" class="flex items-center p-2 bg-green-50 text-green-700 rounded hover:bg-green-100 transition">
                                <i data-lucide="banknote" class="w-4 h-4 mr-2"></i>
                                대출 상품 추가
                            </a>
                            <a th:href="@{/fund/add}" class="flex items-center p-2 bg-purple-50 text-purple-700 rounded hover:bg-purple-100 transition">
                                <i data-lucide="piggy-bank" class="w-4 h-4 mr-2"></i>
                                펀드 상품 추가
                            </a>
                        </div>
                    </div>

                    <div class="space-y-2">
                        <h3 class="font-medium text-gray-700">상품 조회</h3>
                        <div class="space-y-2">
                            <a th:href="@{/cards}" class="flex items-center p-2 bg-blue-50 text-blue-700 rounded hover:bg-blue-100 transition">
                                <i data-lucide="credit-card" class="w-4 h-4 mr-2"></i>
                                카드 상품 목록
                            </a>
                            <a th:href="@{/loans}" class="flex items-center p-2 bg-green-50 text-green-700 rounded hover:bg-green-100 transition">
                                <i data-lucide="banknote" class="w-4 h-4 mr-2"></i>
                                대출 상품 목록
                            </a>
                            <a th:href="@{/funds}" class="flex items-center p-2 bg-purple-50 text-purple-700 rounded hover:bg-purple-100 transition">
                                <i data-lucide="piggy-bank" class="w-4 h-4 mr-2"></i>
                                펀드 상품 목록
                            </a>
                        </div>
                    </div>

                    <div class="space-y-2">
                        <h3 class="font-medium text-gray-700">사용자 관리</h3>
                        <a th:href="@{/userlists}" class="flex items-center p-2 bg-gray-50 text-gray-700 rounded hover:bg-gray-100 transition">
                            <i data-lucide="users" class="w-4 h-4 mr-2"></i>
                            사용자 목록 보기
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 푸터 -->
    <div class="mt-8 text-center text-gray-600">
        <p>© 2024 통합 관리자 대시보드 | Powered by WibeeChat</p>
    </div>
    <div class="mt-2 text-center">
        <a th:href="@{/logout}" class="text-blue-500 hover:underline">Logout</a>
    </div>
</div>

<script>
    // Lucide 아이콘 초기화
    lucide.createIcons();

     // DataTable 초기화
    $(document).ready(function () {
        $('#usageTable').DataTable();
    });
</script>

</body>
</html>
